<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent (Windows) - Command Generator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Installation Command Generator</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="controller.html">Controller</a></li>
                <li><a href="agent_linux.html">Agent (Linux)</a></li>
                <li><a href="agent_windows.html">Agent (Windows)</a></li>
                <li><a href="sizing.html">Sizing Calculator</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <h2>Agent (Windows) Installer</h2>
        <div class="controller-container">
            <form id="windows-form" class="controller-form">
                <fieldset class="base-parameters">
                    <legend>Base Parameters</legend>
                    <div class="form-group">
                        <label for="oms_servers">OMS Servers:</label>
                        <input type="text" id="oms_servers" name="oms_servers" placeholder="server1,server2">
                    </div>
                    <div class="form-group-checkbox">
                        <input type="checkbox" id="oms_autostart" name="oms_autostart">
                        <label for="oms_autostart">OMS Autostart</label>
                    </div>
                    <div class="form-group-checkbox">
                        <input type="checkbox" id="python" name="python">
                        <label for="python">Use Agent Python</label>
                    </div>
                    <div class="form-group">
                        <label for="ac_agent_cluster">Agent Cluster:</label>
                        <input type="text" id="ac_agent_cluster" name="ac_agent_cluster" placeholder="e.g., Default Windows Agents">
                    </div>
                </fieldset>

                <div class="form-group-checkbox">
                    <input type="checkbox" id="toggle-additional-params">
                    <label for="toggle-additional-params">Let me write my parameters manually</label>
                </div>
                <fieldset id="additional-params-section" style="display: none;">
                    <legend>Additional Parameters</legend>
                    <div class="form-group">
                        <label for="additional_params">Additional Parameters:</label>
                        <input type="text" id="additional_params" name="additional_params" placeholder='e.g., AC_AGENT_CLUSTERS=\"Default Linux Agents\"'>
                    </div>
                </fieldset>
                
                <button type="submit">Generate Command</button>
            </form>
            
            <div class="help-section">
                <h3>Windows Agent Installation Guidelines</h3>
                <div class="help-item">
                    <h4>OMS Servers</h4>
                    <p>Specify the OMS (Universal Message Service) hostname or IP address where the Universal Controller is running.</p>
                    <p class="help-example">Single OMS: <code>7878@localhost</code> or <code>oms-server.company.com</code></p>
                    <p class="help-example">HA OMS: <code>oms1.company.com,oms2.company.com</code></p>
                    <p class="help-example">With port: <code>7878@oms-server.company.com</code> (port 7878 is optional)</p>
                </div>
                
                <div class="help-item">
                    <h4>Agent Cluster</h4>
                    <p>Define which cluster this agent belongs to. Agent clusters help organize and manage groups of agents. Enter the value without quotes - they will be automatically added in the generated command.</p>
                    <p class="help-example">Single cluster: <code>Windows Production Agents</code></p>
                    <p class="help-example">Multiple clusters: <code>Production,Windows,Database</code></p>
                    <p class="help-example">Generated command will show: <code>\"Windows Production Agents\"</code></p>
                </div>
                
                <div class="help-item">
                    <h4>Windows Service</h4>
                    <p>The Windows agent automatically installs as a Windows service for automatic startup and proper service management.</p>
                </div>
                
                <div class="help-item">
                    <h4>Agent Python</h4>
                    <p>Use the Python distribution that comes bundled with the Universal Agent instead of relying on external Python installations.</p>
                </div>
            </div>
        </div>
        <div id="command-output" style="display:none; margin-top: 20px;">
            <div class="command-section">
                <h3>Generated Command:</h3>
                <div class="command-line">
                    <pre><code id="generated-command"></code></pre>
                    <button id="copy-button" class="copy-icon" title="Copy to clipboard">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                            <path fill="currentColor" d="M5.503 4.627L5.5 6.75v10.504a3.25 3.25 0 0 0 3.25 3.25h8.616a2.251 2.251 0 0 1-2.122 1.5H8.75A4.75 4.75 0 0 1 4 17.254V6.75c0-.98.627-1.815 1.503-2.123ZM17.75 2A2.25 2.25 0 0 1 20 4.25v13a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-13A2.25 2.25 0 0 1 8.75 2h9Zm0 1.5h-9a.75.75 0 0 0-.75.75v13c0 .414.336.75.75.75h9a.75.75 0 0 0 .75-.75v-13a.75.75 0 0 0-.75-.75Z"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div id="additional-command-output" style="display:none;" class="command-section">
                <h3>Additional Command:</h3>
                <div class="command-line">
                    <pre><code id="additional-command"></code></pre>
                    <button id="copy-additional-button" class="copy-icon" title="Copy to clipboard">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                            <path fill="currentColor" d="M5.503 4.627L5.5 6.75v10.504a3.25 3.25 0 0 0 3.25 3.25h8.616a2.251 2.251 0 0 1-2.122 1.5H8.75A4.75 4.75 0 0 1 4 17.254V6.75c0-.98.627-1.815 1.503-2.123ZM17.75 2A2.25 2.25 0 0 1 20 4.25v13a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-13A2.25 2.25 0 0 1 8.75 2h9Zm0 1.5h-9a.75.75 0 0 0-.75.75v13c0 .414.336.75.75.75h9a.75.75 0 0 0 .75-.75v-13a.75.75 0 0 0-.75-.75Z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </main>
    <footer>
        <p>&copy; 2025</p>
    </footer>
    <script src="script.js"></script>
</body>
</html>